name: Variable Test
on: [push]

env:
  DAY_OF_WEEK: Monday

# https://docs.github.com/ja/actions/writing-workflows/choosing-what-your-workflow-does/control-the-concurrency-of-workflows-and-jobs
concurrency:
  group: ${{ github.workflow }}-${{ github.ref }}
  cancel-in-progress: true

jobs:
  Test-Variables_Development:
    name: 🎁 Test Variables (Development)
    environment: development
    runs-on: ubuntu-latest
    env:
      Greeting: Hello
    steps:
      - name: echo workflow env
        run: echo "workflow env = ${{env.DAY_OF_WEEK}}"
      - name: echo job env
        run: echo "job env = $Greeting"
      - name: echo repository variable
        run: echo "repository val = ${{vars.REPO_VAL}}"
      - name: echo repository environment variable
        run: echo "repository env = ${{vars.REPO_ENV_VAL}}"
      - name: echo repository environment secret
        run: echo "repository env secret = ${{secrets.REPO_ENV_SECRET}}"
      - name: echo undefined variable
        if: vars.UNDEF == ''
        run: echo "undefind variable $UNDEF"
  Test-Variables_Production:
    name: 🎁 Test Variables (Production)
    environment: production
    runs-on: ubuntu-latest
    steps:
      - name: echo repository environment variable
        run: echo "repository env = ${{vars.REPO_ENV_VAL}}"
      - name: echo repository environment secret
        run: echo "repository env secret = ${{secrets.REPO_ENV_SECRET}}"
  Test-Outputs:
    name: 🖼️ Output
    runs-on: ubuntu-latest
    outputs:
      first_step: ${{ steps.step1.outputs.first }}
      second_step: ${{ steps.step2.outputs.second }}
      third_step: ${{ steps.step3.outputs.third }}
    # Map a step output to a job output
    steps:
      - id: step1
        run: echo "first=FIRST_STEP" >> $GITHUB_OUTPUT
      - id: step2
        run: echo "second=SECOND_STEP" >> $GITHUB_OUTPUT
      - id: step3
        run: echo "third=third${{ steps.step2.outputs.second }}" >> $GITHUB_OUTPUT
  Test-OutputsVariables:
    needs: Test-Outputs
    name: Test Output Variables
    runs-on: ubuntu-latest
    steps:
      - name: output first step
        run: echo ${{needs.Test-Outputs.outputs.first_step}}
      - name: output second step
        run: echo ${{needs.Test-Outputs.outputs.second_step}}
      - name: output third step
        run: echo ${{needs.Test-Outputs.outputs.third_step}}
